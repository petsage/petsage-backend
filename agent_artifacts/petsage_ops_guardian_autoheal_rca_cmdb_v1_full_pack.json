{
  "feature": "petsage_ops_guardian_autoheal_rca_cmdb_v1_full_pack",
  "description": "Design the full PetSage Ops Guardian automation layer: auto-healing policies, RCA engine, and self-documenting CMDB/change-log output, integrated with the existing Ops Guardian and backend-builder architecture. Do NOT deploy anything; only produce a complete JSON artifact.",
  "requirements": "You are extending the existing Petsage Ops Guardian architecture (feature: petsage_ops_guardian_full_stack_v1) for project petsage-brain-v33 in region europe-west4. Design a complete, production-grade automation pack that includes: (1) an auto-healing policy engine, (2) a real-time RCA and incident memory engine, and (3) a self-documenting CMDB/change-log output pipeline. The output must be a single JSON artifact named petsage_ops_guardian_autoheal_rca_cmdb_v1_full_pack.json under agent_artifacts/. Requirements in detail: (A) Auto-healing engine: define policy structures and code-level design for actions like safe service restart, rollback to previous Cloud Run revision, scale up/down, temporarily disabling noisy alerts, and scheduling follow-up checks. All actions must be expressed as structured remediation requests to the existing petsage-backend-builder /task endpoint, never direct infra changes. Include example policy objects for common PetSage incidents, such as repeated ValueError Missing feature field in payload, high 5xx rate on petsage-backend, backlog growth on petsage-backend-sub or petsage-mobile-builder-sub, and triage latency degradation on petsage-backend-v52. (B) RCA + incident memory: define an RCA engine that takes an incident event (as defined in petsage_ops_guardian_full_stack_v1), pulls example log and metric context, and produces a structured RCA record with fields like root_cause_hypothesis, contributing_factors, impacted_services, impacted_SLOs, remediation_summary, followup_actions, and owner. Provide full JSON schemas for incident records and RCA records, plus example instances for the current recurring Missing feature field in payload error. Include logic outline for merging repeat incidents into a single problem record with counters and last_seen timestamps. (C) CMDB/change-log output: design a pipeline that continuously writes self-documenting operational records to a GCS bucket such as gs://petsage-global-ops-cmdb (design only). This must include: (1) incident and RCA JSON files, (2) daily or per-incident Markdown or HTML summaries suitable for humans, and (3) periodic configuration snapshots summarising active services, versions (e.g. petsage-backend-v52), key endpoints, and monitoring/alerting configuration. Provide directory layout examples (e.g. incidents/YYYY/MM/DD/..., rca/..., config_snapshots/...), file naming conventions, and example file contents. (D) Integration with evaluation and audit: describe how RCA, incidents and CMDB changes can be used to feed the existing PetSage evaluation/audit pipeline (petsage_observability_safety_governance_audit_pipeline_v1 and petsage_eval_suite_v3_compliance_pack_artifact_unpacker_all_in_one), including which fields should be exported into audit reports for regulators, insurers, and acquirers. (E) Implementation scaffold: include a proposed Python module layout (e.g. ops_guardian/autoheal_engine.py, ops_guardian/rca_engine.py, ops_guardian/cmdb_writer.py) and explain how these modules plug into the Ops Guardian FastAPI service skeleton from petsage_ops_guardian_full_stack_v1. Provide skeleton FastAPI endpoints or internal handlers as needed, but remember that this artifact is design + code scaffold only. Important constraints: do NOT call Google Cloud APIs directly. Do NOT attempt deployment or IAM changes. Everything must be expressed as design, schemas, example configs, and Python skeletons that future steps or agents can turn into real code files, containers and deployments without rethinking the architecture. Ensure strong PetSage branding in human-facing text (PetSage Ops Guardian, PetSage Mission Control, PetSage Global Ops CMDB) while keeping the JSON itself valid.",
  "status": "builder pipeline success"
}