{
  "feature": "petsage_ops_guardian_full_stack_v1",
  "description": "Design and scaffold the full PetSage Ops Guardian and Mission Control stack, including managed Grafana-ready dashboards, native Google Cloud Monitoring dashboards, and a side-car Ops Guardian service that integrates with the existing agentic backend-builder. Do NOT deploy anything; only produce a complete JSON artifact.",
  "requirements": "You are designing PetSage Ops Guardian: a fully branded, enterprise-grade observability and self-healing side-car for PetSage, and PetSage Mission Control: the visual dashboard layer. Output a single JSON artifact named petsage_ops_guardian_full_stack_v1.json that is exhaustive and future-proof.\\n\\nOverall goals:\\n- Project: petsage-brain-v33, region europe-west4.\\n- Core services: petsage-backend, petsage-backend-v52, petsage-backend-builder, petsage-mobile-builder.\\n- Queues: Pub/Sub subscriptions petsage-backend-sub and petsage-mobile-builder-sub.\\n- Existing agentic service: petsage-backend-builder /task endpoint (Cloud Run).\\n- Brand: PetSage, PetSage Mission Control (dashboards), PetSage Ops Guardian (agentic ops brain).\\n\\nThe artifact MUST include at least these sections:\\n\\n1) High-level architecture\\n- A clear textual description of the PetSage Ops Guardian architecture, including: signals (logs, metrics), event types, Ops Guardian service, and integration with petsage-backend-builder.\\n- A list of services and topics involved, with example names for any new Pub/Sub topics you propose (for example, petsage-ops-guardian-events).\\n\\n2) Event model and incident taxonomy\\n- A JSON schema describing incident events, including fields like incident_type, service, severity, summary, first_seen, last_seen, count, sample_logs, and recommended_action.\\n- Define incident types such as: SERVICE_ERROR_SPIKE, MISSING_FEATURE_PAYLOAD_ERROR, QUEUE_BACKLOG_TOO_HIGH, TRIAGE_LATENCY_DEGRADED, BUDGET_THRESHOLD_BREACHED, and any others you think are useful for PetSage.\\n\\n3) Log and metric detection design\\n- Example Cloud Logging filters that would detect the most important errors, including the recurring ValueError about the missing feature field in payload.\\n- Example logs-based metrics definitions for key error signatures.\\n- Example Monitoring alert policies (as JSON) that would trigger incidents for: error rate spikes, queue backlog growth, triage latency degradation, and budget threshold events (even if these require future budget alerts integration).\\n\\n4) PetSage Mission Control dashboards\\n- A full JSON definition for at least one dashboard named PetSage Mission Control suitable for Google Cloud Monitoring dashboards API.\\n- Dashboard sections / groups such as: PetSage Mission Control \u2013 Triage Health, PetSage Mission Control \u2013 Agentic Builders, PetSage Mission Control \u2013 Queues, PetSage Mission Control \u2013 Safety and Errors.\\n- Panels for: request rate, 5xx rate, p95 latency for petsage-backend and petsage-backend-v52; basic health for petsage-backend-builder and petsage-mobile-builder; Pub/Sub backlog and age for petsage-backend-sub and petsage-mobile-builder-sub; key error counts over time.\\n- Use PetSage branding in panel titles and descriptions (PetSage, Mission Control, Ops Guardian), but keep the JSON valid and applicable to Google Monitoring.\\n\\n5) Managed Grafana workspace and dashboards (premium path)\\n- A proposed configuration (can be Terraform-like or gcloud command examples) for creating a Google Cloud Managed Grafana workspace and connecting it to the petsage-brain-v33 project metrics and logs.\\n- One or more example Grafana dashboard JSON definitions that mirror the Mission Control views but with richer layout and branding hooks (for example, dashboard title, panel titles, descriptions that reference PetSage, and notes about where to apply the neon theme and logo).\\n- This section is design + config only; do not instruct any direct deployment.\\n\\n6) Ops Guardian Cloud Run service design\\n- A proposed Cloud Run service named petsage-ops-guardian, including: expected container entrypoint, environment variables, and how it receives events (for example, via Pub/Sub push).\\n- A complete Python FastAPI skeleton for the Ops Guardian service that includes: an endpoint to receive incident events, enrichment logic stubs, severity classification logic stubs, and decision-making stubs for actions.\\n- The Ops Guardian service must NOT directly change any existing services. Instead, it should prepare structured remediation requests for the petsage-backend-builder /task endpoint.\\n\\n7) Integration with petsage-backend-builder (agentic remediation)\\n- Example JSON payloads for /task calls to petsage-backend-builder, including: remediation for recurring errors (like missing feature field), suggestions to harden input validation, and generation of human-readable incident reports.\\n- The design must include a safe mode where Ops Guardian only logs and notifies, and a future mode where it is allowed to trigger remediation tasks automatically.\\n\\n8) Branding and launch readiness\\n- Ensure all dashboard names, section titles, and incident report templates use PetSage branding (PetSage Mission Control, PetSage Ops Guardian).\\n- Include a short checklist describing how this stack supports a lean, no-tech-team launch: where dashboards live, how Ops Guardian reduces manual ops, and which parts can be activated later (such as full auto-remediation and managed Grafana).\\n\\nImportant constraints:\\n- Do NOT attempt to actually call any Google Cloud APIs or deploy resources; this is a design and scaffold artifact only.\\n- The JSON you output must be valid and self-contained so that future steps or agents can turn it directly into code, configuration files, gcloud commands, or Terraform without rethinking the architecture.\\n- The committed_file MUST be named petsage_ops_guardian_full_stack_v1.json and live under agent_artifacts/ in the repository.",
  "status": "builder pipeline success"
}